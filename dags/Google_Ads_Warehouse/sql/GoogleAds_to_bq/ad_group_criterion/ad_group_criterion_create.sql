CREATE OR REPLACE TABLE `shopify-pubsub-project.Data_Warehouse_GoogleAds_Staging.ad_group_criterion`
PARTITION BY DATE_TRUNC(_airbyte_extracted_at, DAY)
AS
SELECT
_airbyte_extracted_at,
ad_group_criterion_ad_group,
ad_group_criterion_age_range_type,
ad_group_criterion_app_payment_model_type,
ad_group_criterion_approval_status,
ad_group_criterion_audience_audience,
ad_group_criterion_bid_modifier,
ad_group_criterion_cpc_bid_micros,
ad_group_criterion_cpm_bid_micros,
ad_group_criterion_cpv_bid_micros,
ad_group_criterion_criterion_id,
ad_group_criterion_custom_audience_custom_audience,
ad_group_criterion_custom_intent_custom_intent,
ad_group_criterion_display_name,
ad_group_criterion_effective_cpc_bid_micros,
ad_group_criterion_effective_cpc_bid_source,
ad_group_criterion_effective_cpm_bid_micros,
ad_group_criterion_effective_cpm_bid_source,
ad_group_criterion_effective_cpv_bid_micros,
ad_group_criterion_effective_cpv_bid_source,
ad_group_criterion_gender_type,
ad_group_criterion_income_range_type,
ad_group_criterion_keyword_match_type,
ad_group_criterion_keyword_text,
ad_group_criterion_mobile_app_category_mobile_app_category_constant,
ad_group_criterion_negative,
ad_group_criterion_parental_status_type,
ad_group_criterion_position_estimates_estimated_add_clicks_at_first_position_cpc,
ad_group_criterion_position_estimates_estimated_add_cost_at_first_position_cpc,
ad_group_criterion_position_estimates_first_page_cpc_micros,
ad_group_criterion_position_estimates_first_position_cpc_micros,
ad_group_criterion_position_estimates_top_of_page_cpc_micros,
ad_group_criterion_quality_info_creative_quality_score,
ad_group_criterion_quality_info_post_click_quality_score,
ad_group_criterion_quality_info_quality_score,
ad_group_criterion_quality_info_search_predicted_ctr,
ad_group_criterion_resource_name,
ad_group_criterion_status,
ad_group_criterion_system_serving_status,
ad_group_criterion_topic_topic_constant,
ad_group_criterion_type,
ad_group_criterion_user_interest_user_interest_category,
ad_group_criterion_user_list_user_list,
ad_group_criterion_webpage_criterion_name,
ad_group_criterion_youtube_channel_channel_id,
ad_group_id,
change_status_last_change_date_time,
deleted_at,
JSON_EXTRACT_SCALAR(ad_group_criterion_disapproval_reasons, '$[0]') AS criterion_disapproval_reasons,
JSON_EXTRACT_SCALAR(ad_group_criterion_final_urls, '$[0]') AS criterion_final_urls,
JSON_EXTRACT_SCALAR(ad_group_criterion_labels, '$[0]') AS criterion_labels,
FROM
  shopify-pubsub-project.pilgrim_bi_google_ads.ad_group_criterion
