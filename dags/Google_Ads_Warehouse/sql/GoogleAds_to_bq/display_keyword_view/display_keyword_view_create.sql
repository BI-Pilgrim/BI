create or replace table `shopify-pubsub-project.Data_Warehouse_GoogleAds_Staging.display_keyword_view`
partition by date_trunc(_airbyte_extracted_at, day)
as
  select
    _airbyte_extracted_at,
    ad_group_base_ad_group,
    ad_group_criterion_criterion_id,
    ad_group_criterion_effective_cpc_bid_micros,
    ad_group_criterion_effective_cpc_bid_source,
    ad_group_criterion_effective_cpm_bid_micros,
    ad_group_criterion_effective_cpm_bid_source,
    ad_group_criterion_effective_cpv_bid_micros,
    ad_group_criterion_effective_cpv_bid_source,
    ad_group_criterion_final_mobile_urls,
    ad_group_criterion_final_urls,
    ad_group_criterion_keyword_match_type,
    ad_group_criterion_keyword_text,
    ad_group_criterion_negative,
    ad_group_criterion_status,
    ad_group_criterion_tracking_url_template,
    ad_group_criterion_url_custom_parameters,
    ad_group_id,
    ad_group_name,
    ad_group_status,
    campaign_base_campaign,
    campaign_bidding_strategy,
    campaign_bidding_strategy_type,
    campaign_id,
    campaign_name,
    campaign_status,
    customer_currency_code,
    customer_descriptive_name,
    customer_id,
    customer_time_zone,
    metrics_active_view_cpm,
    metrics_active_view_ctr,
    metrics_active_view_impressions,
    metrics_active_view_measurability,
    metrics_active_view_measurable_cost_micros,
    metrics_active_view_measurable_impressions,
    metrics_active_view_viewability,
    metrics_all_conversions,
    metrics_all_conversions_from_interactions_rate,
    metrics_all_conversions_value,
    metrics_average_cost,
    metrics_average_cpc,
    metrics_average_cpe,
    metrics_average_cpm,
    metrics_average_cpv,
    metrics_clicks,
    metrics_conversions,
    metrics_conversions_from_interactions_rate,
    metrics_conversions_value,
    metrics_cost_micros,
    metrics_cost_per_all_conversions,
    metrics_cost_per_conversion,
    metrics_cross_device_conversions,
    metrics_ctr,
    metrics_engagement_rate,
    metrics_engagements,
    metrics_gmail_forwards,
    metrics_gmail_saves,
    metrics_gmail_secondary_clicks,
    metrics_impressions,
    metrics_interaction_rate,
    metrics_interactions,
    metrics_value_per_all_conversions,
    metrics_value_per_conversion,
    metrics_video_quartile_p100_rate,
    metrics_video_quartile_p25_rate,
    metrics_video_quartile_p50_rate,
    metrics_video_quartile_p75_rate,
    metrics_video_view_rate,
    metrics_video_views,
    metrics_view_through_conversions,
    segments_ad_network_type,
    segments_date,
    segments_day_of_week,
    segments_device,
    segments_month,
    segments_quarter,
    segments_week,
    segments_year,
    JSON_extract_array(metrics_interaction_event_types,'$') as interaction_event_type,
    JSON_EXTRACT_ARRAY(ad_group_targeting_setting_target_restrictions, '$') as target_setting_target_restriction,
  from
    shopify-pubsub-project.pilgrim_bi_google_ads.display_keyword_view
